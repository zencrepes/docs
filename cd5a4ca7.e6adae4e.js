(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{81:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return o})),t.d(n,"metadata",(function(){return s})),t.d(n,"rightToc",(function(){return l})),t.d(n,"default",(function(){return c}));var r=t(2),i=t(6),a=(t(0),t(91)),o={id:"querying",title:"Querying",sidebar_label:"Querying"},s={unversionedId:"use/querying",id:"use/querying",isDocsHomePage:!1,title:"Querying",description:"ZenCrepes uses SQON as a query language for its front-end, queries are at the core of all of the filtering and general data fetching used on the UI (i.e. everything is a query).",source:"@site/docs/use/querying.md",slug:"/use/querying",permalink:"/docs/use/querying",editUrl:"https://github.com/zencrepes/docs/tree/master/docs/docs/use/querying.md",version:"current",sidebar_label:"Querying",sidebar:"someSidebar",previous:{title:"Overview",permalink:"/docs/use/overview"},next:{title:"Overview",permalink:"/docs/github/overview"}},l=[{value:"Saving and Opening queries",id:"saving-and-opening-queries",children:[]},{value:"Sharing queries",id:"sharing-queries",children:[]},{value:"Editing a query",id:"editing-a-query",children:[{value:"Tag your custom filters",id:"tag-your-custom-filters",children:[]}]},{value:"Using NOT with nested fields",id:"using-not-with-nested-fields",children:[]}],u={rightToc:l};function c(e){var n=e.components,t=Object(i.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},u,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("p",null,"ZenCrepes uses ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://arranger.readthedocs.io/en/latest/src/sqon.html"}),"SQON")," as a query language for its front-end, queries are at the core of all of the filtering and general data fetching used on the UI (i.e. everything is a query)."),Object(a.b)("p",null,"SQON queries are then processed through ZAPI and automatically converted into Elasticsearch queries, which are then used to build aggregations, fetch documents, ..."),Object(a.b)("h2",{id:"saving-and-opening-queries"},"Saving and Opening queries"),Object(a.b)("p",null,"You can save queries and open them by clicking on the corresponding icons. Queries are saved in your browser's cache, so you're going to loose them if you clear your cache or use a different browser."),Object(a.b)("h2",{id:"sharing-queries"},"Sharing queries"),Object(a.b)("p",null,"You cannot share queries per-se, but if you send the URL of the page you're currently on, users will automatically see the same filters. They can then save those filters."),Object(a.b)("h2",{id:"editing-a-query"},"Editing a query"),Object(a.b)("p",null,"Not everything is feasible (or easily feasible) in a UI, for example NOT is sometimes complex to represent in facets."),Object(a.b)("p",null,"Instead of building an overly complicated UI, ZenCrepes allows you to edit queries. You can access this modal by clicking on the pen icon on the right side of the query bar."),Object(a.b)("p",{align:"center"},Object(a.b)("img",{alt:"Issues View",title:"Issues view",src:"/img/zencrepes-edit-query.png",width:"640"})),Object(a.b)("p",null,"You will also automatically see a list of the fields supported by default (technically any of the Elasticsearch fields can be used)."),Object(a.b)("h3",{id:"tag-your-custom-filters"},"Tag your custom filters"),Object(a.b)("p",null,"ZenCrepes is going to handle sightly differently filters you add through manually editing the query, versus the filters that are dynamically added when you're clicking on the UI."),Object(a.b)("p",null,"If you're editing a query and its content is too complex for ZenCrepes to understand, simply add a ",Object(a.b)("inlineCode",{parentName:"p"},"tag")," field to your filter, it will then be ignored by ZenCrepes facets."),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-json"}),'{\n  "op": "and",\n  "content": [\n    {\n      "op": "in",\n      "tag": "ignore-me",\n      "content": {\n        "field": "labels.edges.node.name.keyword",\n        "value": ["zui", "zapi"]\n      }\n    }\n  ]\n}\n')),Object(a.b)("h2",{id:"using-not-with-nested-fields"},"Using NOT with nested fields"),Object(a.b)("p",null,"Although SQON supports 'not-in' to exclude results, this currently doesn't work on nested fields. You can easily spot nested field as they contain \"edges\" in their definition. But in general a nested field is a field that can take multiple values.\nFor example: :"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"An issue can have multiple labels, labels is a nested field"),Object(a.b)("li",{parentName:"ul"},"An issue can only have one repository, repository is not a nested field")),Object(a.b)("p",null,"But you can still perform a NOT logic on a nested field. The sample query below search for all issues with labels ",Object(a.b)("inlineCode",{parentName:"p"},"zui")," OR ",Object(a.b)("inlineCode",{parentName:"p"},"zapi")," but NOT ",Object(a.b)("inlineCode",{parentName:"p"},"bug")),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-json"}),'{\n  "op": "and",\n  "content": [\n    {\n      "op": "in",\n      "content": {\n        "field": "labels.edges.node.name.keyword",\n        "value": ["zui", "zapi"]\n      }\n    },\n    {\n      "op": "not",\n      "content": [\n        {\n          "op": "in",\n          "content": {\n            "field": "labels.edges.node.name.keyword",\n            "value": ["bug"]\n          }\n        }\n      ]\n    }\n  ]\n}\n')),Object(a.b)("p",null,"Note that ZenCrepes query display does not handle such nested filters, and will display ",Object(a.b)("inlineCode",{parentName:"p"},"Advanced Filter (edit to see)")," instead of allowing you to dynamically remove values."))}c.isMDXComponent=!0},91:function(e,n,t){"use strict";t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return f}));var r=t(0),i=t.n(r);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var u=i.a.createContext({}),c=function(e){var n=i.a.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},d=function(e){var n=c(e.components);return i.a.createElement(u.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return i.a.createElement(i.a.Fragment,{},n)}},b=i.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,o=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(t),b=r,f=d["".concat(o,".").concat(b)]||d[b]||p[b]||a;return t?i.a.createElement(f,s(s({ref:n},u),{},{components:t})):i.a.createElement(f,s({ref:n},u))}));function f(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,o=new Array(a);o[0]=b;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var u=2;u<a;u++)o[u]=t[u];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,t)}b.displayName="MDXCreateElement"}}]);