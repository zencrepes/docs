<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.63">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-1488177-27","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Try ZenCrepes self-hosted | ZenCrepes</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Try ZenCrepes self-hosted | ZenCrepes"><meta data-react-helmet="true" name="description" content="This section of the documentation contains instructions to get started quickly with ZenCrepes self-hosted (see Introduction for more details) using docker and docker-compose. This doesn&#x27;t aim at providing instructions to install a production-grade environment, but to take the shortest path to a running ZenCrepes environment."><meta data-react-helmet="true" property="og:description" content="This section of the documentation contains instructions to get started quickly with ZenCrepes self-hosted (see Introduction for more details) using docker and docker-compose. This doesn&#x27;t aim at providing instructions to install a production-grade environment, but to take the shortest path to a running ZenCrepes environment."><meta data-react-helmet="true" property="og:url" content="https://docs.zencrepes.io/docs/try"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.zencrepes.io/docs/try"><link rel="stylesheet" href="/styles.4e51d241.css">
<link rel="preload" href="/styles.2584cd3b.js" as="script">
<link rel="preload" href="/runtime~main.d62aa030.js" as="script">
<link rel="preload" href="/main.4184cea5.js" as="script">
<link rel="preload" href="/1.9a159a6a.js" as="script">
<link rel="preload" href="/2.f6f39416.js" as="script">
<link rel="preload" href="/35.70ff253e.js" as="script">
<link rel="preload" href="/36.c0e6a14f.js" as="script">
<link rel="preload" href="/935f2afb.2840cf23.js" as="script">
<link rel="preload" href="/17896441.04de4d84.js" as="script">
<link rel="preload" href="/319409b5.f5f1c42d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/zencrepes.svg" alt="ZenCrepes Logo"><strong class="navbar__title">ZenCrepes</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/zencrepes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://github.com/zencrepes/zencrepes/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Issues</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/zencrepes.svg" alt="ZenCrepes Logo"><strong class="navbar__title">ZenCrepes</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/zencrepes" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://github.com/zencrepes/zencrepes/issues" target="_blank" rel="noopener noreferrer" class="menu__link">Issues</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/features">Features</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/try">Try It !</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/faq">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Serverless</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/serverless">Discover</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Install</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/install/architecture">Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/install/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/install/authentication">Authentication</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Use</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/use/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/use/querying">Querying</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Datasets</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">GitHub</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/issues">Issues</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/repositories">Repositories</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/labels">Labels</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/milestones">Milestones</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/projects">Projects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/prs">Pull Requests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/releases">Releases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/vulnerabilities">Vulnerabilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/watchers">Watchers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/github/import">Import Issues</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">CircleCI</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/circleci/envvars">Env Vars</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/circleci/pipelines">Pipelines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/circleci/insights">Insights</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Jira</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/jira/issues">Issues</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Tests</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tests/states">States</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Develop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/develop/getstarted">Get Started</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Try ZenCrepes self-hosted</h1></header><div class="markdown"><p>This section of the documentation contains instructions to get started quickly with ZenCrepes self-hosted (see Introduction for more details) using <code>docker</code> and <code>docker-compose</code>. This doesn&#x27;t aim at providing instructions to install a production-grade environment, but to take the shortest path to a running ZenCrepes environment.</p><p>This documentation has been tested on Mac, instructions should be identical on GNU/Linux.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="pre-requisites"></a>Pre-requisites<a aria-hidden="true" tabindex="-1" class="hash-link" href="#pre-requisites" title="Direct link to heading">#</a></h2><p>The following elements are needed to follow this page:</p><ul><li>Docker and Docker-compose</li><li>A publicly reachable host (for the Webhook configuration)</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="github-configuration"></a>GitHub Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#github-configuration" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="obtain-a-github-developer-token"></a>Obtain a GitHub developer token<a aria-hidden="true" tabindex="-1" class="hash-link" href="#obtain-a-github-developer-token" title="Direct link to heading">#</a></h3><p>Log-in your profile in GitHub, and go to your settings.</p><p><img src="/assets/images/zencrepes-dev-github-settings-4996038f8563ac57f575f3cdbb5dd5ac.png"></p><p>In the left-side menu, click on <code>Developer settings</code> at the bottom.</p><p>Then select <code>Personal access tokens</code> and <code>Generate new token</code>.</p><p><img src="/assets/images/github-dev-settings-66128413827ebf915812f0476c182755.png"></p><p>Give your token a name, and select the following scopes:</p><ul><li>repo</li><li>admin:org</li></ul><p>Those scopes should be sufficient to get started, click on <code>Generate token</code> and keep this token safe (don&#x27;t share it!).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="register-a-webhook"></a>Register a WebHook<a aria-hidden="true" tabindex="-1" class="hash-link" href="#register-a-webhook" title="Direct link to heading">#</a></h3><p>The next thing is you need to to register a WebHook, it will be used to receive events on your organization (or on individual repositories).</p><p>Go to your organization (or repo settings) and click on <code>Webhooks</code></p><p><img src="/assets/images/github-org-webhook-e51d339fd865f0cb627297b6b5faf528.png"></p><p>Then click on <code>Add Webhook</code>, and enter the following settings:</p><ul><li><strong>Payload URL</strong>: The zqueue host that will be listening to the events, for simplicity&#x27;s sake and in the context of this guide we&#x27;re going to expose port 3003, on the assumption you do not configure SSL (don&#x27;t do that for production), you&#x27;d just have to enter: <code>http://YOUR_DOMAIN_OR_IP:3003/github/webhook</code>.</li><li><strong>Content type</strong>: Select <code>application/json</code>.</li><li><strong>Secret</strong>: Enter a secret and keep it safe, it will be used by zqueue to verify incoming events.</li><li><strong>Which events...</strong>: Select the events you&#x27;d like to receive, you can select <code>Send me everything</code> for the purpose of getting started quickly.</li><li><strong>Active</strong>: Unselect this box until the environment is running (the last step of this guide).</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="clone-the-docker-repo"></a>Clone the docker repo<a aria-hidden="true" tabindex="-1" class="hash-link" href="#clone-the-docker-repo" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> ~/zencrepes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> ~/zencrepes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> clone git@github.com:zencrepes/docker.git</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> docker</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> /tmp/zencrepes-data</span></div></div></div></div></div><p>PS: <code>/tmp/zencrepes-data</code> is where the configuration file and cache data will be stored, if you whish to use a different directory, you&#x27;ll need to update the <code>docker-compose.yml</code> file.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="configure-zencrepes"></a>Configure ZenCrepes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#configure-zencrepes" title="Direct link to heading">#</a></h2><p>The next thing you need to do is to configure ZenCrepes, a template configuration can be obtained easily by starting either <code>zindexer</code>, <code>zapi</code> or <code>zqueue</code>. At startup those tools will look for a configuration file, and if they can&#x27;t find any, will generate a default one and terminate themselves.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -it </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --name zapi </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --env </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">CONFIG_PATH</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/root/zencrepes </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --mount </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">bind,source</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/tmp/zencrepes-data,target</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/root/zencrepes </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  zencrepes/zqueue:latest</span></div></div></div></div></div><p>You&#x27;ll see an error message similar to the below and your container will stop.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ node dist/main.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[Nest] 63   - 06/08/2020, 1:56:15 AM   [NestFactory] Starting Nest application...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[Nest] 63   - 06/08/2020, 1:56:15 AM   [ConfService] Initialized configuration file with defaults in: /root/zencrepes/config.yml +88ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[Nest] 63   - 06/08/2020, 1:56:15 AM   [ConfService] Please EDIT the configuration file first +0ms</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">error Command failed with exit code 1.</span></div></div></div></div></div><p>A default configuration file (config.yml) is now located in <code>/tmp/zencrepes-data</code>. Note that the path defailed in the logs above (<code>/root/zencrepes/config.yml</code>) refers to the container&#x27;s filesystem, so use your local mount point (<code>/tmp/zencrepes-data/config.yml</code>).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="configure-zencrepes-1"></a>Configure ZenCrepes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#configure-zencrepes-1" title="Direct link to heading">#</a></h2><p>Open-up <code>/tmp/zencrepes-data/config.yml</code>, and modify the following elements:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-yml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">elasticsearch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;http://zc_elasticsearch:9200&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">redis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;redis://zc_redis:6379&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">github</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">username</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> YOUR_GITHUB_USERNAME</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> THE_TOKEN_YOU_GOT_AT_THE_BEGINNING_OF_THIS_DOC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">webhook</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">secret</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> THE_SECRET_CONFIGURED_IN_THE_WEBHOOK_SECTION</span></div></div></div></div></div><p>For the elasticsearch host, use <code>http://zc_elasticsearch:9200</code> as this corresponds to the setup with docker-compose, same applies for redis. Leave all the other settings as-is.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="start-the-environment"></a>Start the environment<a aria-hidden="true" tabindex="-1" class="hash-link" href="#start-the-environment" title="Direct link to heading">#</a></h2><p>Simply pull the latest version of all of the images and start the environment.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose pull</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose up -d</span></div></div></div></div></div><p>ZenCrepes is now available at <code>http://localhost:3000</code> but hasn&#x27;t been configured yet ! At that point you should be able to access it, but the left-side menu will be mostly empty.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="enable-repositories"></a>Enable repositories<a aria-hidden="true" tabindex="-1" class="hash-link" href="#enable-repositories" title="Direct link to heading">#</a></h2><p>To facilite discovery (and limit dependencies to external tools), zindexer (which is a CLI tool) has been dockerized, and a small (hugly?) <a href="https://github.com/zencrepes/zindexer/blob/master/startup.sh" target="_blank" rel="noopener noreferrer">hack</a> was done to ensure this process doesn&#x27;t shut down after initial execution, keeping the Docker container alive. This will allow you to interact with the command tool without needing to have node and npm running on your machine.</p><p>The first step is to identify repositories to load data from (those are called <code>sources</code> in ZenCrepes).</p><p>Run the following command:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer sources --help</span></div></div></div></div></div><p>This gives view a quick view at the available commands, which ultimately define what data will be fetched.</p><div type="tip">Yes, there needs to be two `zindexer` in the command above, the first one is the docker container name, while the second one is the command to run within that container.</div><p>To get started quickly, with as much data as possible, run the following command:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer sources -a -g affiliated</span></div></div></div></div></div><p>This will enable all repositories from all GitHub organizations affiliated with your account. But be careful, it could represent a lot of data !</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="fetch-data"></a>Fetch data<a aria-hidden="true" tabindex="-1" class="hash-link" href="#fetch-data" title="Direct link to heading">#</a></h2><p>ZenCrepes can fetch various different datasets from GitHub, you can get a list of the available datasets by running the following command</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github --help</span></div></div></div></div></div><p>You can then fetch the data of your choice (or all of it) using the commands below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github:issues</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github:labels</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github:milestones</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github:projects</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github:pullrequests</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github:releases</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github:repos</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github:stargazers</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github:vulnerabilities</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it zc_zindexer zindexer github:watchers</span></div></div></div></div></div><p>Data is fetched per repository, once a repository has been fully loaded its data becomes available in ZenCrepes. So if you are fetching a lot of data, you don&#x27;t need to wait until the end to start playing with the tool.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="important-notes"></a>Important notes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#important-notes" title="Direct link to heading">#</a></h2><p>Authentication/Authorization is not enabled, so pay attention to where you are spinning up this environment.</p><p>Don&#x27;t run zindexer multiple times in parallel with the same token (or username for that matter). If you do that you will hit GitHub rate throttling. On top of that, it&#x27;s in everyone best interest to play gently with GitHub API.</p><p>GitHub will issue 5000 tokens per 1-hour period, which should be plenty for most discovery situations. You can monitor token consumption while <code>zindexer</code> is running, by watching for the following messages:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">GitHub Tokens - remaining: 3724 query cost: 1 (token will reset at: 2020-04-29T04:18:44Z)</span></div></div></div></div></div><p>ZenCrepes will pause data loading, until token reset, if you do consume all tokens.</p><p>If you re-run the command later on, <code>zindexer</code> will only fetch newly updated PRs.</p><p>On the long-run, <code>zindexer</code> will only be useful for the initial data fetching (historical data). another tool <code>zqueue</code> (not built yet), will take care of fetching data based on events it will receive from GitHub. <code>zindexer</code> is only needed to fetch data, it doesn&#x27;t need to be running constantly.</p><p>That&#x27;s it, happy discovery !</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-keycloak"></a>Using Keycloak<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-keycloak" title="Direct link to heading">#</a></h2><p>ZenCrepes can be configured to use Keycloak to provide an authorization layer, this is required if you want to use any of the features directly interacting with GitHub (for example bulk modifying labels).</p><p>To start the ZenCrepes docker environment with Keycloak enabled, simply run:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose -f docker-compose-keycloak.yml up -d</span></div></div></div></div></div><p>And follow configuration instructions available in the <a href="https://docs.zencrepes.io/docs/install/authentication" target="_blank" rel="noopener noreferrer">dedicated section on Authentication &amp; Authorization</a>, not running the container manually since it is provided by <code>docker-compose-keycloak.yml</code>.</p><p>Keycloak configuration is a bit peculiar as it needs to be reachable from both your webbrowser (for the redirection from GitHub) and directly from the API, through the <code>KEYCLOAK_AUTH_SERVER_URL</code> parameter.</p><p>And if those two are not using the same URL, you are going to see the following error <code>{&quot;message&quot;:&quot;jwt issuer invalid. expected: http://zc_keycloak:8080/auth/realms/ZenCrepes&quot;}</code> when trying to access the API.</p><p>The easy solution for this is to edit your local <code>/etc/hosts</code> file, to create an alias for zc_keycloak.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">##</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Host Database</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># localhost is used to configure the loopback interface</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># when the system is booting.  Do not change this entry.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">##</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1       localhost</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1       zc_keycloak</span></div></div></div></div></div><p>Then edit your github OAuth configuration (which you did when following the Authz configuration above), replacing <code>localhost</code> with <code>zc_keycloak</code> in both <code>Homepage URL</code> and <code>Authorization callback URL</code>.</p><p>In production, Keycloak would be hosted properly and have its own URL, which will make this configuration tweak not needed.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/zencrepes/docs/tree/master/docs/docs/try.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/features"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Features</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/faq"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">FAQ Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pre-requisites" class="table-of-contents__link">Pre-requisites</a></li><li><a href="#github-configuration" class="table-of-contents__link">GitHub Configuration</a><ul><li><a href="#obtain-a-github-developer-token" class="table-of-contents__link">Obtain a GitHub developer token</a></li><li><a href="#register-a-webhook" class="table-of-contents__link">Register a WebHook</a></li></ul></li><li><a href="#clone-the-docker-repo" class="table-of-contents__link">Clone the docker repo</a></li><li><a href="#configure-zencrepes" class="table-of-contents__link">Configure ZenCrepes</a></li><li><a href="#configure-zencrepes-1" class="table-of-contents__link">Configure ZenCrepes</a></li><li><a href="#start-the-environment" class="table-of-contents__link">Start the environment</a></li><li><a href="#enable-repositories" class="table-of-contents__link">Enable repositories</a></li><li><a href="#fetch-data" class="table-of-contents__link">Fetch data</a></li><li><a href="#important-notes" class="table-of-contents__link">Important notes</a></li><li><a href="#using-keycloak" class="table-of-contents__link">Using Keycloak</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="http://slack.overture.bio/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack @overture.bio #app_zencrepes</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 ZenCrepes. Site built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.2584cd3b.js"></script>
<script src="/runtime~main.d62aa030.js"></script>
<script src="/main.4184cea5.js"></script>
<script src="/1.9a159a6a.js"></script>
<script src="/2.f6f39416.js"></script>
<script src="/35.70ff253e.js"></script>
<script src="/36.c0e6a14f.js"></script>
<script src="/935f2afb.2840cf23.js"></script>
<script src="/17896441.04de4d84.js"></script>
<script src="/319409b5.f5f1c42d.js"></script>
</body>
</html>